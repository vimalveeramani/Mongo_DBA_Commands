//syntax

var bulk = db.music.initializeOrderedBulkOp();
bulk.find( { "genre": "pop" } ).delete();
bulk.execute()


//Example:
var bulk = db.callbacklogs.initializeOrderedBulkOp();

bulk.find({
  date: { 
    $gte: ISODate("2024-10-01T00:00:00Z"), 
    $lte: ISODate("2024-12-31T23:59:59Z") 
  }
}).delete();

bulk.execute();


//example with limit

const batchSize = 10000;
let deletedCount;

do {
  // Create a new bulk operation for each batch
  const bulk = db.callbacklogs.initializeOrderedBulkOp();

  // Find and queue documents for deletion
  bulk.find({
    date: { 
      $gte: ISODate("2024-10-01T00:00:00Z"), 
      $lte: ISODate("2024-12-31T23:59:59Z") 
    }
  }).delete();

  // Execute the bulk delete for this batch
  const result = bulk.execute();

  // Get the number of deleted documents in this batch
  deletedCount = result.nRemoved || result.nDeleted || 0;
  print(`Deleted ${deletedCount} documents in this batch`);

  // Optionally, you can pause briefly between batches:
  // sleep(100); // Sleep for 100 ms
} while (deletedCount === batchSize);



//documentaion links
https://www.mongodb.com/docs/manual/reference/method/Bulk.find.delete/

ref:https://stackoverflow.com/questions/75410077/how-should-i-efficiently-delete-alot-of-records-from-a-mongodb-collection
//